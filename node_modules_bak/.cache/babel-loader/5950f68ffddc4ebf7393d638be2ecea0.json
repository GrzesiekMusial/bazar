{"ast":null,"code":"import { delay } from \"lodash\";\nimport { toast } from \"react-toastify\";\nimport * as imagesBase from \"../api/images\";\n\nconst imageSave = async (item, edit, image) => {\n  if (!(image.length > 0 && typeof image[0] !== \"string\")) return item.images;\n  if (edit) edit.images.forEach(img => imagesBase.remove(img));\n  const response = await uploadImage(image);\n  if (response.ok) return response.data;else throw toast.error(\"Error occured on saving!\");\n};\n\nconst checkPrice = async price => {\n  try {\n    if (price) {\n      price = price.trim();\n      price = +parseFloat(price).toFixed(2);\n    } else {\n      price = 0;\n    }\n  } catch (e) {}\n\n  await sleep(2000);\n  console.log(\"ok1\");\n  return;\n};\n\nfunction sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nconst handleSave = async (item, edit, image, base) => {\n  await checkPrice(item.price);\n  console.log(\"ok2\");\n  item.images = await imageSave(item, edit, image);\n\n  if (edit) {\n    item._id = edit._id;\n    const response = await base.edit(item);\n    if (!response.ok) throw toast.error(\"Error occured on saving!\");\n    return response.data;\n  }\n\n  const response = await base.add(item);\n  if (!response.ok) throw toast.error(\"Error occured on saving!\");\n  return response.data;\n};\n\nconst uploadImage = image => {\n  const form = new FormData();\n  image.forEach(img => form.append(\"image\", img));\n  return imagesBase.add(form);\n};\n\nexport { handleSave };","map":{"version":3,"sources":["C:/dev/TESTY/TEST NATIVE/bazar/src/methods/save.js"],"names":["delay","toast","imagesBase","imageSave","item","edit","image","length","images","forEach","img","remove","response","uploadImage","ok","data","error","checkPrice","price","trim","parseFloat","toFixed","e","sleep","console","log","ms","Promise","resolve","setTimeout","handleSave","base","_id","add","form","FormData","append"],"mappings":"AAAA,SAASA,KAAT,QAAsB,QAAtB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,OAAO,KAAKC,UAAZ,MAA4B,eAA5B;;AAEA,MAAMC,SAAS,GAAG,OAAOC,IAAP,EAAaC,IAAb,EAAmBC,KAAnB,KAA6B;AAC3C,MAAI,EAAEA,KAAK,CAACC,MAAN,GAAe,CAAf,IAAoB,OAAOD,KAAK,CAAC,CAAD,CAAZ,KAAoB,QAA1C,CAAJ,EAAyD,OAAOF,IAAI,CAACI,MAAZ;AAEzD,MAAIH,IAAJ,EAAUA,IAAI,CAACG,MAAL,CAAYC,OAAZ,CAAqBC,GAAD,IAASR,UAAU,CAACS,MAAX,CAAkBD,GAAlB,CAA7B;AAEV,QAAME,QAAQ,GAAG,MAAMC,WAAW,CAACP,KAAD,CAAlC;AACA,MAAIM,QAAQ,CAACE,EAAb,EAAiB,OAAOF,QAAQ,CAACG,IAAhB,CAAjB,KACK,MAAMd,KAAK,CAACe,KAAN,CAAY,0BAAZ,CAAN;AACR,CARD;;AAUA,MAAMC,UAAU,GAAG,MAAOC,KAAP,IAAiB;AAChC,MAAI;AACA,QAAIA,KAAJ,EAAW;AACPA,MAAAA,KAAK,GAAGA,KAAK,CAACC,IAAN,EAAR;AACAD,MAAAA,KAAK,GAAG,CAACE,UAAU,CAACF,KAAD,CAAV,CAAkBG,OAAlB,CAA0B,CAA1B,CAAT;AACH,KAHD,MAGO;AACHH,MAAAA,KAAK,GAAG,CAAR;AACH;AACJ,GAPD,CAOE,OAAOI,CAAP,EAAU,CAAE;;AACd,QAAMC,KAAK,CAAC,IAAD,CAAX;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACA;AACH,CAZD;;AAcA,SAASF,KAAT,CAAeG,EAAf,EAAmB;AACf,SAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAaC,UAAU,CAACD,OAAD,EAAUF,EAAV,CAAnC,CAAP;AACH;;AAED,MAAMI,UAAU,GAAG,OAAO1B,IAAP,EAAaC,IAAb,EAAmBC,KAAnB,EAA0ByB,IAA1B,KAAmC;AAClD,QAAMd,UAAU,CAACb,IAAI,CAACc,KAAN,CAAhB;AACAM,EAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACArB,EAAAA,IAAI,CAACI,MAAL,GAAc,MAAML,SAAS,CAACC,IAAD,EAAOC,IAAP,EAAaC,KAAb,CAA7B;;AAEA,MAAID,IAAJ,EAAU;AACND,IAAAA,IAAI,CAAC4B,GAAL,GAAW3B,IAAI,CAAC2B,GAAhB;AACA,UAAMpB,QAAQ,GAAG,MAAMmB,IAAI,CAAC1B,IAAL,CAAUD,IAAV,CAAvB;AACA,QAAI,CAACQ,QAAQ,CAACE,EAAd,EAAkB,MAAMb,KAAK,CAACe,KAAN,CAAY,0BAAZ,CAAN;AAClB,WAAOJ,QAAQ,CAACG,IAAhB;AACH;;AAED,QAAMH,QAAQ,GAAG,MAAMmB,IAAI,CAACE,GAAL,CAAS7B,IAAT,CAAvB;AACA,MAAI,CAACQ,QAAQ,CAACE,EAAd,EAAkB,MAAMb,KAAK,CAACe,KAAN,CAAY,0BAAZ,CAAN;AAClB,SAAOJ,QAAQ,CAACG,IAAhB;AACH,CAfD;;AAiBA,MAAMF,WAAW,GAAIP,KAAD,IAAW;AAC3B,QAAM4B,IAAI,GAAG,IAAIC,QAAJ,EAAb;AACA7B,EAAAA,KAAK,CAACG,OAAN,CAAeC,GAAD,IAASwB,IAAI,CAACE,MAAL,CAAY,OAAZ,EAAqB1B,GAArB,CAAvB;AACA,SAAOR,UAAU,CAAC+B,GAAX,CAAeC,IAAf,CAAP;AACH,CAJD;;AAMA,SAASJ,UAAT","sourcesContent":["import { delay } from \"lodash\";\r\nimport { toast } from \"react-toastify\";\r\nimport * as imagesBase from \"../api/images\";\r\n\r\nconst imageSave = async (item, edit, image) => {\r\n    if (!(image.length > 0 && typeof image[0] !== \"string\")) return item.images;\r\n\r\n    if (edit) edit.images.forEach((img) => imagesBase.remove(img));\r\n\r\n    const response = await uploadImage(image);\r\n    if (response.ok) return response.data;\r\n    else throw toast.error(\"Error occured on saving!\");\r\n};\r\n\r\nconst checkPrice = async (price) => {\r\n    try {\r\n        if (price) {\r\n            price = price.trim();\r\n            price = +parseFloat(price).toFixed(2);\r\n        } else {\r\n            price = 0;\r\n        }\r\n    } catch (e) {}\r\n    await sleep(2000);\r\n    console.log(\"ok1\");\r\n    return;\r\n};\r\n\r\nfunction sleep(ms) {\r\n    return new Promise((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\nconst handleSave = async (item, edit, image, base) => {\r\n    await checkPrice(item.price);\r\n    console.log(\"ok2\");\r\n    item.images = await imageSave(item, edit, image);\r\n\r\n    if (edit) {\r\n        item._id = edit._id;\r\n        const response = await base.edit(item);\r\n        if (!response.ok) throw toast.error(\"Error occured on saving!\");\r\n        return response.data;\r\n    }\r\n\r\n    const response = await base.add(item);\r\n    if (!response.ok) throw toast.error(\"Error occured on saving!\");\r\n    return response.data;\r\n};\r\n\r\nconst uploadImage = (image) => {\r\n    const form = new FormData();\r\n    image.forEach((img) => form.append(\"image\", img));\r\n    return imagesBase.add(form);\r\n};\r\n\r\nexport { handleSave };\r\n"]},"metadata":{},"sourceType":"module"}